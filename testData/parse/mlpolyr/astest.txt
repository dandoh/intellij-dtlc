FILE
  MLPolyRLetExpImpl(LET_EXP)
    PsiElement(KW_LET)('let')
    PsiWhiteSpace(' ')
    MLPolyRDefImpl(DEF)
      PsiElement(KW_FUN)('fun')
      PsiWhiteSpace(' ')
      MLPolyRFunctionImpl(FUNCTION)
        MLPolyRNamePatImpl(NAME_PAT)
          PsiElement(ID)('f')
        PsiWhiteSpace(' ')
        MLPolyRListPatImpl(LIST_PAT)
          PsiElement(LP)('(')
          MLPolyRAsPatImpl(AS_PAT)
            MLPolyRNamePatImpl(NAME_PAT)
              PsiElement(ID)('r')
            PsiWhiteSpace(' ')
            PsiElement(KW_AS)('as')
            PsiWhiteSpace(' ')
            MLPolyRCbPatImpl(CB_PAT)
              PsiElement(LCB)('{')
              PsiWhiteSpace(' ')
              MLPolyRFieldPatternImpl(FIELD_PATTERN)
                MLPolyRNamePatImpl(NAME_PAT)
                  PsiElement(ID)('a')
              PsiElement(COMMA)(',')
              PsiWhiteSpace(' ')
              MLPolyRFieldPatternImpl(FIELD_PATTERN)
                MLPolyRNamePatImpl(NAME_PAT)
                  PsiElement(ID)('b')
              PsiElement(COMMA)(',')
              PsiWhiteSpace(' ')
              MLPolyRFieldPatternImpl(FIELD_PATTERN)
                PsiElement(DOTDOTDOT)('...')
                PsiWhiteSpace(' ')
                PsiElement(EQ)('=')
                PsiWhiteSpace(' ')
                MLPolyRNamePatImpl(NAME_PAT)
                  PsiElement(ID)('rest')
              PsiWhiteSpace(' ')
              PsiElement(RCB)('}')
          PsiElement(RP)(')')
        PsiWhiteSpace(' ')
        PsiElement(EQ)('=')
        PsiWhiteSpace('\n\t')
        MLPolyRIfExpImpl(IF_EXP)
          PsiElement(KW_IF)('if')
          PsiWhiteSpace(' ')
          MLPolyRGtExpImpl(GT_EXP)
            MLPolyRAtomicExpImpl(ATOMIC_EXP)
              MLPolyRIdentifierImpl(IDENTIFIER)
                PsiElement(ID)('a')
            PsiWhiteSpace(' ')
            PsiElement(GT)('>')
            PsiWhiteSpace(' ')
            MLPolyRAtomicExpImpl(ATOMIC_EXP)
              PsiElement(INT)('0')
          PsiWhiteSpace(' ')
          PsiElement(KW_THEN)('then')
          PsiWhiteSpace(' ')
          MLPolyRAtomicExpImpl(ATOMIC_EXP)
            MLPolyRIdentifierImpl(IDENTIFIER)
              PsiElement(ID)('r')
          PsiWhiteSpace('\n\t')
          PsiElement(KW_ELSE)('else')
          PsiWhiteSpace(' ')
          MLPolyRRecordExpImpl(RECORD_EXP)
            PsiElement(LCB)('{')
            PsiWhiteSpace(' ')
            MLPolyRFieldImpl(FIELD)
              MLPolyRLabelImpl(LABEL)
                PsiElement(ID)('a')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                PsiElement(INT)('10')
            PsiElement(COMMA)(',')
            PsiWhiteSpace(' ')
            MLPolyRFieldImpl(FIELD)
              MLPolyRLabelImpl(LABEL)
                PsiElement(ID)('b')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                MLPolyRStringImpl(STRING)
                  PsiElement(STR)('"foo"')
            PsiElement(COMMA)(',')
            PsiWhiteSpace(' ')
            MLPolyRFieldImpl(FIELD)
              PsiElement(DOTDOTDOT)('...')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                MLPolyRIdentifierImpl(IDENTIFIER)
                  PsiElement(ID)('rest')
            PsiWhiteSpace(' ')
            PsiElement(RCB)('}')
    PsiWhiteSpace('\n    ')
    MLPolyRDefImpl(DEF)
      PsiElement(KW_FUN)('fun')
      PsiWhiteSpace(' ')
      MLPolyRFunctionImpl(FUNCTION)
        MLPolyRNamePatImpl(NAME_PAT)
          PsiElement(ID)('show')
        PsiWhiteSpace(' ')
        MLPolyRCbPatImpl(CB_PAT)
          PsiElement(LCB)('{')
          PsiWhiteSpace(' ')
          MLPolyRFieldPatternImpl(FIELD_PATTERN)
            MLPolyRNamePatImpl(NAME_PAT)
              PsiElement(ID)('a')
          PsiElement(COMMA)(',')
          PsiWhiteSpace(' ')
          MLPolyRFieldPatternImpl(FIELD_PATTERN)
            MLPolyRNamePatImpl(NAME_PAT)
              PsiElement(ID)('b')
          PsiElement(COMMA)(',')
          PsiWhiteSpace(' ')
          MLPolyRFieldPatternImpl(FIELD_PATTERN)
            MLPolyRNamePatImpl(NAME_PAT)
              PsiElement(ID)('c')
          PsiElement(COMMA)(',')
          PsiWhiteSpace(' ')
          MLPolyRFieldPatternImpl(FIELD_PATTERN)
            PsiElement(DOTDOTDOT)('...')
          PsiWhiteSpace(' ')
          PsiElement(RCB)('}')
        PsiWhiteSpace(' ')
        PsiElement(EQ)('=')
        PsiWhiteSpace(' ')
        MLPolyRAppExpImpl(APP_EXP)
          MLPolyRSuffixExpImpl(SUFFIX_EXP)
            MLPolyRAtomicExpImpl(ATOMIC_EXP)
              MLPolyRIdentifierImpl(IDENTIFIER)
                PsiElement(ID)('String')
            PsiElement(DOT)('.')
            MLPolyRLabelImpl(LABEL)
              PsiElement(ID)('output')
          PsiWhiteSpace(' ')
          MLPolyRAtomicExpImpl(ATOMIC_EXP)
            PsiElement(LP)('(')
            MLPolyRAppExpImpl(APP_EXP)
              MLPolyRSuffixExpImpl(SUFFIX_EXP)
                MLPolyRAtomicExpImpl(ATOMIC_EXP)
                  MLPolyRIdentifierImpl(IDENTIFIER)
                    PsiElement(ID)('String')
                PsiElement(DOT)('.')
                MLPolyRLabelImpl(LABEL)
                  PsiElement(ID)('concat')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                PsiElement(LSB)('[')
                MLPolyRAtomicExpImpl(ATOMIC_EXP)
                  MLPolyRIdentifierImpl(IDENTIFIER)
                    PsiElement(ID)('b')
                PsiElement(COMMA)(',')
                PsiWhiteSpace(' ')
                MLPolyRAtomicExpImpl(ATOMIC_EXP)
                  MLPolyRStringImpl(STRING)
                    PsiElement(STR)('"\n"')
                PsiElement(RSB)(']')
            PsiElement(RP)(')')
    PsiWhiteSpace('\n')
    PsiElement(KW_IN)('in')
    PsiWhiteSpace(' ')
    MLPolyRAppExpImpl(APP_EXP)
      MLPolyRAtomicExpImpl(ATOMIC_EXP)
        MLPolyRIdentifierImpl(IDENTIFIER)
          PsiElement(ID)('show')
      PsiWhiteSpace(' ')
      MLPolyRAtomicExpImpl(ATOMIC_EXP)
        PsiElement(LP)('(')
        MLPolyRAppExpImpl(APP_EXP)
          MLPolyRAtomicExpImpl(ATOMIC_EXP)
            MLPolyRIdentifierImpl(IDENTIFIER)
              PsiElement(ID)('f')
          PsiWhiteSpace(' ')
          MLPolyRRecordExpImpl(RECORD_EXP)
            PsiElement(LCB)('{')
            PsiWhiteSpace(' ')
            MLPolyRFieldImpl(FIELD)
              MLPolyRLabelImpl(LABEL)
                PsiElement(ID)('a')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                PsiElement(INT)('0')
            PsiElement(COMMA)(',')
            PsiWhiteSpace(' ')
            MLPolyRFieldImpl(FIELD)
              MLPolyRLabelImpl(LABEL)
                PsiElement(ID)('b')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                MLPolyRStringImpl(STRING)
                  PsiElement(STR)('"test1"')
            PsiElement(COMMA)(',')
            PsiWhiteSpace(' ')
            MLPolyRFieldImpl(FIELD)
              MLPolyRLabelImpl(LABEL)
                PsiElement(ID)('c')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                PsiElement(INT)('22')
            PsiWhiteSpace(' ')
            PsiElement(RCB)('}')
        PsiElement(RP)(')')
    PsiElement(SEMI)(';')
    PsiWhiteSpace('\n   ')
    MLPolyRAppExpImpl(APP_EXP)
      MLPolyRAtomicExpImpl(ATOMIC_EXP)
        MLPolyRIdentifierImpl(IDENTIFIER)
          PsiElement(ID)('show')
      PsiWhiteSpace(' ')
      MLPolyRAtomicExpImpl(ATOMIC_EXP)
        PsiElement(LP)('(')
        MLPolyRAppExpImpl(APP_EXP)
          MLPolyRAtomicExpImpl(ATOMIC_EXP)
            MLPolyRIdentifierImpl(IDENTIFIER)
              PsiElement(ID)('f')
          PsiWhiteSpace(' ')
          MLPolyRRecordExpImpl(RECORD_EXP)
            PsiElement(LCB)('{')
            PsiWhiteSpace(' ')
            MLPolyRFieldImpl(FIELD)
              MLPolyRLabelImpl(LABEL)
                PsiElement(ID)('a')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                PsiElement(INT)('1')
            PsiElement(COMMA)(',')
            PsiWhiteSpace(' ')
            MLPolyRFieldImpl(FIELD)
              MLPolyRLabelImpl(LABEL)
                PsiElement(ID)('b')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                MLPolyRStringImpl(STRING)
                  PsiElement(STR)('"test2"')
            PsiElement(COMMA)(',')
            PsiWhiteSpace(' ')
            MLPolyRFieldImpl(FIELD)
              MLPolyRLabelImpl(LABEL)
                PsiElement(ID)('c')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                PsiElement(INT)('33')
            PsiElement(COMMA)(',')
            PsiWhiteSpace(' ')
            MLPolyRFieldImpl(FIELD)
              MLPolyRLabelImpl(LABEL)
                PsiElement(ID)('d')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                PsiElement(INT)('4')
            PsiWhiteSpace(' ')
            PsiElement(RCB)('}')
        PsiElement(RP)(')')
    PsiElement(SEMI)(';')
    PsiWhiteSpace('\n   ')
    MLPolyRAtomicExpImpl(ATOMIC_EXP)
      PsiElement(INT)('0')
    PsiWhiteSpace('\n')
    PsiElement(KW_END)('end')