FILE
  MlangDefineImpl(DEFINE)
    PsiElement(KW_DEFINE)('define')
    PsiWhiteSpace(' ')
    MlangIdentImpl(IDENT)
      PsiElement(IDENTIFIER)('refl')
    MlangTeleImpl(TELE)
      PsiElement(LPAREN)('(')
      MlangParamImpl(PARAM)
        MlangParamIdentImpl(PARAM_IDENT)
          PsiElement(HASH)('#')
          MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
            PsiElement(IDENTIFIER)('A')
        PsiElement(COLON)(':')
        PsiWhiteSpace(' ')
        MlangKeywordExprImpl(KEYWORD_EXPR)
          PsiElement(KW_TYPE)('type')
      PsiElement(COMMA)(',')
      PsiWhiteSpace(' ')
      MlangParamImpl(PARAM)
        MlangParamIdentImpl(PARAM_IDENT)
          PsiElement(HASH)('#')
          MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
            PsiElement(IDENTIFIER)('x')
        PsiElement(COLON)(':')
        PsiWhiteSpace(' ')
        MlangRefExprImpl(REF_EXPR)
          PsiElement(IDENTIFIER)('A')
      PsiElement(RPAREN)(')')
    PsiElement(COLON)(':')
    PsiWhiteSpace(' ')
    MlangPathExprImpl(PATH_EXPR)
      MlangRefExprImpl(REF_EXPR)
        PsiElement(IDENTIFIER)('x')
      PsiWhiteSpace(' ')
      PsiElement(TRIPLE_EQ)('≡')
      PsiWhiteSpace(' ')
      MlangRefExprImpl(REF_EXPR)
        PsiElement(IDENTIFIER)('x')
    PsiWhiteSpace(' ')
    PsiElement(EQ)('=')
    PsiWhiteSpace(' ')
    MlangLambdaExprImpl(LAMBDA_EXPR)
      MlangParamIdentImpl(PARAM_IDENT)
        MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
          PsiElement(IDENTIFIER)('i')
      PsiWhiteSpace(' ')
      PsiElement(ARROW)('→')
      PsiWhiteSpace(' ')
      MlangRefExprImpl(REF_EXPR)
        PsiElement(IDENTIFIER)('x')
  PsiWhiteSpace('\n\n')
  MlangDefineImpl(DEFINE)
    PsiElement(KW_DEFINE)('define')
    PsiWhiteSpace(' ')
    MlangIdentImpl(IDENT)
      PsiElement(IDENTIFIER)('flat')
    PsiElement(COLON)(':')
    PsiWhiteSpace(' ')
    MlangKeywordExprImpl(KEYWORD_EXPR)
      PsiElement(KW_TYPE)('type')
    PsiWhiteSpace(' ')
    PsiElement(EQ)('=')
    PsiWhiteSpace(' ')
    MlangSumExprImpl(SUM_EXPR)
      PsiElement(KW_SUM)('sum')
      PsiWhiteSpace(' ')
      PsiElement(LBRACE)('{')
      PsiWhiteSpace('\n   ')
      MlangCaseImpl(CASE)
        PsiElement(KW_CASE)('case')
        PsiWhiteSpace(' ')
        MlangParamIdentImpl(PARAM_IDENT)
          MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
            PsiElement(IDENTIFIER)('true')
        PsiWhiteSpace(' ')
        MlangParamIdentImpl(PARAM_IDENT)
          MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
            PsiElement(IDENTIFIER)('false')
      PsiWhiteSpace('\n')
      PsiElement(RBRACE)('}')
  PsiWhiteSpace('\n\n')
  MlangDefineImpl(DEFINE)
    PsiElement(KW_DEFINE)('define')
    PsiWhiteSpace(' ')
    MlangIdentImpl(IDENT)
      PsiElement(IDENTIFIER)('flat2')
    PsiElement(COLON)(':')
    PsiWhiteSpace(' ')
    MlangKeywordExprImpl(KEYWORD_EXPR)
      PsiElement(KW_TYPE)('type')
    PsiWhiteSpace(' ')
    PsiElement(EQ)('=')
    PsiWhiteSpace(' ')
    MlangSumExprImpl(SUM_EXPR)
      PsiElement(KW_SUM)('sum')
      PsiWhiteSpace(' ')
      PsiElement(LBRACE)('{')
      PsiWhiteSpace('\n   ')
      MlangCaseImpl(CASE)
        PsiElement(KW_CASE)('case')
        PsiWhiteSpace(' ')
        MlangParamIdentImpl(PARAM_IDENT)
          MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
            PsiElement(IDENTIFIER)('true')
        PsiWhiteSpace(' ')
        MlangParamIdentImpl(PARAM_IDENT)
          MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
            PsiElement(IDENTIFIER)('false')
      PsiWhiteSpace('\n')
      PsiElement(RBRACE)('}')
  PsiWhiteSpace('\n\n')
  PsiComment(line comment)('// non-recursive record and sum has structural equality, their case/field name/order needs to be exactly the same')
  PsiWhiteSpace('\n')
  MlangDefineImpl(DEFINE)
    PsiElement(KW_DEFINE)('define')
    PsiWhiteSpace(' ')
    MlangIdentImpl(IDENT)
      PsiElement(IDENTIFIER)('flat_is_ok')
    PsiElement(COLON)(':')
    PsiWhiteSpace(' ')
    MlangPathExprImpl(PATH_EXPR)
      MlangRefExprImpl(REF_EXPR)
        PsiElement(IDENTIFIER)('flat')
      PsiWhiteSpace(' ')
      PsiElement(TRIPLE_EQ)('≡')
      PsiWhiteSpace(' ')
      MlangRefExprImpl(REF_EXPR)
        PsiElement(IDENTIFIER)('flat2')
    PsiWhiteSpace(' ')
    PsiElement(EQ)('=')
    PsiWhiteSpace(' ')
    MlangRefExprImpl(REF_EXPR)
      PsiElement(IDENTIFIER)('refl')
  PsiWhiteSpace('\n\n')
  MlangDefineImpl(DEFINE)
    PsiElement(KW_DEFINE)('define')
    PsiWhiteSpace(' ')
    MlangIdentImpl(IDENT)
      PsiElement(IDENTIFIER)('r1')
    PsiElement(COLON)(':')
    PsiWhiteSpace(' ')
    MlangUpExprImpl(UP_EXPR)
      PsiElement(LIFT)('^')
      MlangKeywordExprImpl(KEYWORD_EXPR)
        PsiElement(KW_TYPE)('type')
    PsiWhiteSpace(' ')
    PsiElement(EQ)('=')
    PsiWhiteSpace(' ')
    MlangRecordExprImpl(RECORD_EXPR)
      PsiElement(KW_RECORD)('record')
      PsiWhiteSpace(' ')
      PsiElement(LBRACE)('{')
      PsiWhiteSpace('\n  ')
      MlangFieldImpl(FIELD)
        PsiElement(KW_FIELD)('field')
        PsiWhiteSpace(' ')
        MlangParamImpl(PARAM)
          MlangParamIdentImpl(PARAM_IDENT)
            MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
              PsiElement(IDENTIFIER)('a')
          PsiWhiteSpace(' ')
          MlangParamIdentImpl(PARAM_IDENT)
            MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
              PsiElement(IDENTIFIER)('b')
          PsiElement(COLON)(':')
          PsiWhiteSpace(' ')
          MlangKeywordExprImpl(KEYWORD_EXPR)
            PsiElement(KW_TYPE)('type')
      PsiWhiteSpace('\n')
      PsiElement(RBRACE)('}')
  PsiWhiteSpace('\n\n')
  MlangDefineImpl(DEFINE)
    PsiElement(KW_DEFINE)('define')
    PsiWhiteSpace(' ')
    MlangIdentImpl(IDENT)
      PsiElement(IDENTIFIER)('r2')
    PsiElement(COLON)(':')
    PsiWhiteSpace(' ')
    MlangUpExprImpl(UP_EXPR)
      PsiElement(LIFT)('^')
      MlangKeywordExprImpl(KEYWORD_EXPR)
        PsiElement(KW_TYPE)('type')
    PsiWhiteSpace(' ')
    PsiElement(EQ)('=')
    PsiWhiteSpace(' ')
    MlangRecordExprImpl(RECORD_EXPR)
      PsiElement(KW_RECORD)('record')
      PsiWhiteSpace(' ')
      PsiElement(LBRACE)('{')
      PsiWhiteSpace('\n  ')
      MlangFieldImpl(FIELD)
        PsiElement(KW_FIELD)('field')
        PsiWhiteSpace(' ')
        MlangParamImpl(PARAM)
          MlangParamIdentImpl(PARAM_IDENT)
            MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
              PsiElement(IDENTIFIER)('a')
          PsiWhiteSpace(' ')
          MlangParamIdentImpl(PARAM_IDENT)
            MlangParamIdentExplicitImpl(PARAM_IDENT_EXPLICIT)
              PsiElement(IDENTIFIER)('b')
          PsiElement(COLON)(':')
          PsiWhiteSpace(' ')
          MlangKeywordExprImpl(KEYWORD_EXPR)
            PsiElement(KW_TYPE)('type')
      PsiWhiteSpace('\n')
      PsiElement(RBRACE)('}')
  PsiWhiteSpace('\n\n')
  MlangDefineImpl(DEFINE)
    PsiElement(KW_DEFINE)('define')
    PsiWhiteSpace(' ')
    MlangIdentImpl(IDENT)
      PsiElement(IDENTIFIER)('r_is_ok')
    PsiElement(COLON)(':')
    PsiWhiteSpace(' ')
    MlangPathExprImpl(PATH_EXPR)
      MlangRefExprImpl(REF_EXPR)
        PsiElement(IDENTIFIER)('r1')
      PsiWhiteSpace(' ')
      PsiElement(TRIPLE_EQ)('≡')
      PsiWhiteSpace(' ')
      MlangRefExprImpl(REF_EXPR)
        PsiElement(IDENTIFIER)('r2')
    PsiWhiteSpace(' ')
    PsiElement(EQ)('=')
    PsiWhiteSpace(' ')
    MlangUpExprImpl(UP_EXPR)
      PsiElement(LIFT)('^')
      MlangRefExprImpl(REF_EXPR)
        PsiElement(IDENTIFIER)('refl')